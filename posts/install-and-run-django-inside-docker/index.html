<!DOCTYPE html>
<html prefix="
        og: http://ogp.me/ns# article: http://ogp.me/ns/article#
    " vocab="http://ogp.me/ns" lang="en">
<head>
<meta charset="utf-8">
<meta name="viewport" content="width=device-width">
<title>Install and run Django completely inside Docker | Karl Lorey</title>
<link href="../../assets/css/all-nocdn.css" rel="stylesheet" type="text/css">
<meta name="theme-color" content="#5670d4">
<meta name="generator" content="Nikola (getnikola.com)">
<link rel="alternate" type="application/rss+xml" title="RSS" hreflang="en" href="../../rss.xml">
<link rel="canonical" href="https://karllorey.com/posts/install-and-run-django-inside-docker/">
<!--[if lt IE 9]><script src="../../assets/js/html5shiv-printshiv.min.js"></script><![endif]--><meta name="author" content="Karl Lorey">
<link rel="prev" href="../g-suite-for-personal-personal-domain-and-email/" title="G Suite for your personal domain and email" type="text/html">
<meta property="og:site_name" content="Karl Lorey">
<meta property="og:title" content="Install and run Django completely inside Docker">
<meta property="og:url" content="https://karllorey.com/posts/install-and-run-django-inside-docker/">
<meta property="og:description" content="This guide will show you how to install Django inside Docker with docker-compose 
and without installing any dependencies on the host system.
Since there are a few quirks and I have to look it up myse">
<meta property="og:type" content="article">
<meta property="article:published_time" content="2020-05-03T13:33:57+02:00">
<meta property="article:tag" content="Django">
<meta property="article:tag" content="Docker">
<meta property="article:tag" content="Python">
<meta property="article:tag" content="Tech">
<link rel="stylesheet" href="https://use.fontawesome.com/releases/v5.6.3/css/all.css" integrity="sha384-UHRtZLI+pbxtHCWp1t77Bi1L4ZtiqrqD80Kn4Z8NTSRyMA2Fd33n5dQ8lWUE00s/" crossorigin="anonymous">
<link href="https://fonts.googleapis.com/css?family=Lato:300,400,700%7CPlayfair+Display:400,700" rel="stylesheet">
<link rel="stylesheet" href="https://maxcdn.bootstrapcdn.com/bootstrap/4.0.0/css/bootstrap.min.css" integrity="sha384-Gn5384xqQ1aoWXA+058RXPxPg6fy4IWvTNh0E263XmFcJlSAwiGgFAW/dAiS6JXm" crossorigin="anonymous">
<link rel="stylesheet" href="../../assets/css/style.css">
<script>
  var dnt = navigator.doNotTrack || window.doNotTrack || navigator.msDoNotTrack;
  if (dnt != "1" && dnt != "yes") {
    (function(i,s,o,g,r,a,m){i['GoogleAnalyticsObject']=r;i[r]=i[r]||function(){
      (i[r].q=i[r].q||[]).push(arguments)},i[r].l=1*new Date();a=s.createElement(o),
        m=s.getElementsByTagName(o)[0];a.async=1;a.src=g;m.parentNode.insertBefore(a,m)
    })(window,document,'script','//www.google-analytics.com/analytics.js','__gaTracker');

    __gaTracker('create', 'UA-73074199-1', 'auto');
    __gaTracker('set', 'forceSSL', true);
    __gaTracker('set', 'anonymizeIp', true);
    __gaTracker('send','pageview');
  } else {
    console.debug("Respecting Do-Not-Track, not loading analytics. See https://www.paulfurley.com/google-analytics-dnt/");
  }
</script>
</head>
<body>
    <a href="#content" class="sr-only sr-only-focusable">Skip to main content</a>
    <div id="container">
             <header id="header"><p id="brand" class="display-1">
        <a href="https://karllorey.com/" title="Karl Lorey" rel="home">

            <span id="blog-title">Karl Lorey</span>
        </a>
    </p>

            <nav><ul class="nav justify-content-center">
<li class="nav-link">
                <a href="../../human/">Human</a>
            </li>
            <li class="nav-link">
                <a href="../../founder/">Founder</a>
            </li>
            <li class="nav-link">
                <a href="../../portfolio/">Maker</a>
            </li>
            <li class="nav-link">
                <a href="../../techie/">Techie</a>
            </li>
            <li class="nav-link">
                <a href="../../vc/">Investor</a>
            </li>
            <li class="nav-link">
                <a href="../../speaker/">Speaker</a>
            </li>
            <li class="nav-link">
                <a href="../../blog/">Lorey Ipsum</a>
            </li>
        </ul></nav></header><main id="content" class="page"><hr style="margin-bottom: 50px">
<article class="post-text h-entry hentry postpage" itemscope="itemscope" itemtype="http://schema.org/Article"><header><h1 class="p-name entry-title" itemprop="headline name"><a href="." class="u-url">Install and run Django completely inside Docker</a></h1>

        <div class="metadata">
            <p class="byline author vcard p-author h-card"><span class="byline-name fn p-name" itemprop="author">
                    Karl Lorey
            </span></p>
            <p class="dateline">
            <a href="." rel="bookmark">
            <time class="published dt-published" datetime="2020-05-03T13:33:57+02:00" itemprop="datePublished" title="2020-05-03">2020-05-03</time></a>
            </p>
                    <p class="sourceline"><a href="index.md" class="sourcelink">Source</a></p>

        </div>
        
    </header><div class="e-content entry-content" itemprop="articleBody text">
        <div>
<p>This guide will show you how to install Django inside Docker with docker-compose 
and without installing any dependencies on the host system.
Since there are a few quirks and I have to look it up myself every damn time,
here's a guide hopefully helping me and other the next time.</p>
<p>This guide will:</p>
<ul>
<li>help you install the newest version of django inside your docker container</li>
<li>be independent of your host OS and python version, so you can always get the newest version inside docker</li>
<li>provide a basic setup of django inside docker with docker-compose to build upon
<!-- TEASER_END -->
</li>
</ul>
<h2>Basic requirements file</h2>
<p>Start with a requirements.txt file containing only:</p>
<pre class="code literal-block"><span></span><code><span class="err">django</span>
</code></pre>


<p>Save it as <code>requirements.txt</code>.</p>
<h2>Basic Dockerfile</h2>
<p>Firstly, a Dockerfile is needed to set up and run our project.
We'll use a basic version you can expand later.
It uses Python 3.8, installs all dependencies from your <code>requirements.txt</code> file,
and then copies your project files into the image.</p>
<p>So copy this in your <code>Dockerfile</code>:</p>
<pre class="code literal-block"><span></span><code><span class="k">FROM</span> <span class="s">python:3.8</span>

<span class="k">WORKDIR</span><span class="s"> /code</span>

<span class="c"># copy and install requirements first </span>
<span class="c"># -&gt; speeds up build if requirements haven't changed</span>
<span class="k">COPY</span> requirements.txt /code/
<span class="k">RUN</span> pip install -r requirements.txt

<span class="c"># copy rest of files</span>
<span class="c"># (not needed since we also mount a volume, </span>
<span class="c"># but you won't mount in production)</span>
<span class="k">COPY</span> . /code/
</code></pre>


<h2>Basic docker-compose</h2>
<p>In <code>docker-compose.yml</code>:</p>
<pre class="code literal-block"><span></span><code><span class="nt">version</span><span class="p">:</span> <span class="s">'3'</span>

<span class="nt">services</span><span class="p">:</span>
  <span class="nt">web</span><span class="p">:</span>
    <span class="nt">build</span><span class="p">:</span> <span class="l l-Scalar l-Scalar-Plain">.</span>
    <span class="nt">volumes</span><span class="p">:</span>
      <span class="p p-Indicator">-</span> <span class="l l-Scalar l-Scalar-Plain">.:/code/</span>
    <span class="nt">command</span><span class="p">:</span> <span class="l l-Scalar l-Scalar-Plain">bash</span>
    <span class="nt">tty</span><span class="p">:</span> <span class="l l-Scalar l-Scalar-Plain">True</span>
    <span class="nt">ports</span><span class="p">:</span>
    <span class="c1"># external is the port you use on your host, i.e. localhost:8000</span>
    <span class="c1"># internal is the port django uses inside the container</span>
    <span class="c1"># format: external:internal </span>
    <span class="p p-Indicator">-</span> <span class="s">"8000:8000"</span>
</code></pre>


<h2>Running it all</h2>
<p>After having set up the above files, run the following steps:</p>
<ol>
<li>Run <code>docker-compose build</code> to build the images.</li>
<li>Run <code>docker-compose up</code> to start the container, leave it running.</li>
<li>Run <code>docker-compose exec web pip freeze &gt; requirements.txt</code> to pin the installed dependencies to their actual version. <code>requirements.txt</code> should now contain version numbers.</li>
<li>Run <code>docker-compose exec web django-admin startproject YOURNAME .</code> (mind the dot!) to start a new django project in the current directory.</li>
<li>Run <code>sudo chown -R $USER ./</code> to own the docker-generated files. Otherwise you'll get file permission problems when working with the generated files on your host (outside of docker).</li>
<li>Run <code>docker-compose exec web python ./manage.py runserver 0.0.0.0:8000</code>.</li>
</ol>
<p>You should now be able to access a congratulations page at <code>localhost:8000</code>.</p>
<h2>Next steps</h2>
<p>If you're interested in setting up Django for production, 
feel free to check out my guide on 
<a href="http://karllorey.com/posts/django-production-docker-mod-wsgi/">how to set up Django deployment for production</a> for the same stack.</p>
<h2>Note: Changing ports</h2>
<p>If you want to change the port to access your Django application, 
you only have to change the external port, i.e. the <code>docker-compose.yml</code> file.
So to switch to port 80, change the line below <code>ports:</code> to</p>
<pre class="code literal-block"><span></span><code><span class="nt">ports</span><span class="p">:</span>
<span class="p p-Indicator">-</span> <span class="s">"80:8000"</span>
</code></pre>


<p>Then the container can be accessed with <code>localhost:80</code> or just <code>localhost</code> (as 80 is the default).</p>
</div>
    </div>

    <hr class="mt-5 mb-5">
<aside class="postpromonav"><nav><p class="mb-0">Tags:</p>
                    <ul itemprop="keywords" class="tags">
<li><a class="tag p-category" href="../../categories/django/" rel="tag">Django</a></li>
            <li><a class="tag p-category" href="../../categories/docker/" rel="tag">Docker</a></li>
            <li><a class="tag p-category" href="../../categories/python/" rel="tag">Python</a></li>
            <li><a class="tag p-category" href="../../categories/tech/" rel="tag">Tech</a></li>
        </ul>
<p class="mb-0">Posts:</p>
                    <ul class="pager hidden-print">
<li class="previous">
                <a href="../g-suite-for-personal-personal-domain-and-email/" rel="prev" title="G Suite for your personal domain and email">Previous post</a>
            </li>
        </ul></nav></aside></article><hr style="margin-top: 50px"></main><nav><ul class="nav justify-content-center">
<li class="nav-link">
                 <a href="../../archive.html">Archive</a>
             </li>
             <li class="nav-link">
                 <a href="../../categories/">Categories</a>
             </li>
             <li class="nav-link">
                 <a href="../../rss.xml">RSS feed</a>
             </li>
         </ul></nav><footer><p>I'm Karl Lorey–Techie, Founder, and Investor living in Karlsruhe, Germany. Let's get in touch.</p>
    <p class="lead socials">
            <a href="https://angel.co/karllorey" target="_blank"><i class="fab fa-angellist"></i></a>
            <a href="https://www.crunchbase.com/person/karl-lorey" target="_blank"><i class="fas fa-cube"></i></a>
            <a href="https://github.com/lorey" target="_blank"><i class="fab fa-github"></i></a>
            <a href="https://gitlab.com/lorey" target="_blank"><i class="fab fa-gitlab"></i></a>
            <a href="https://www.goodreads.com/karllorey" target="_blank"><i class="fab fa-goodreads"></i></a>
            <a href="https://www.instagram.com/karllorey" target="_blank"><i class="fab fa-instagram"></i></a>
            <a href="https://www.linkedin.com/in/karllorey" target="_blank"><i class="fab fa-linkedin"></i></a>
            <a href="https://medium.com/@karllorey" target="_blank"><i class="fab fa-medium"></i></a>
            <a href="https://www.meetup.com/members/196097665/" target="_blank"><i class="fab fa-meetup"></i></a>
            <a href="https://www.producthunt.com/@karllorey" target="_blank"><i class="fab fa-product-hunt"></i></a>
            <a href="https://www.researchgate.net/profile/Karl_Lorey" target="_blank"><i class="fab fa-researchgate"></i></a>
            <a href="https://twitter.com/karllorey" target="_blank"><i class="fab fa-twitter"></i></a>
    </p>
    <p>
        This site uses cookies and external services to improve your experience.<br>
        At least if you don't refuse by sending <a href="http://randomwalker.info/donottrack-archive/" target="_blank">Do Not Track</a>.
    </p>
    <p>© Copyright 2020 by Karl Lorey. <a href="http://karllorey.de/impressum" target="_blank">Legal/Imprint</a>.</p>
</footer>
</div>
                <script src="../../assets/js/all-nocdn.js"></script><script>
    baguetteBox.run('div#content', {
        ignoreClass: 'islink',
        captions: function(element) {
            return element.getElementsByTagName('img')[0].alt;
    }});
    </script>
</body>
</html>
